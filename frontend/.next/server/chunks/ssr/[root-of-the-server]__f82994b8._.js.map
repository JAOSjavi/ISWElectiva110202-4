{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Javier/Desktop/ISWElectiva110202-4/frontend/app/reservar/page.jsx"],"sourcesContent":["'use client'\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { FaHome, FaMapMarkerAlt, FaSignOutAlt, FaMoneyBill, FaBell, FaCog, FaPowerOff, FaBed, FaWifi, FaTv, FaSnowflake, FaShower, FaCalendarAlt, FaLock } from 'react-icons/fa';\r\nimport Link from 'next/link';\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport Calendar from 'react-calendar';\r\nimport 'react-calendar/dist/Calendar.css';\r\nimport { useNotification } from '../../components/NotificationContext';\r\nimport Image from 'next/image';\r\n\r\nexport default function Reservar() {\r\n  const [rooms, setRooms] = useState([]);\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [selectedRoom, setSelectedRoom] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [updatingRooms, setUpdatingRooms] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [dateRange, setDateRange] = useState([new Date(), new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)]);\r\n  const [reservaActiva, setReservaActiva] = useState(false);\r\n  const [checkingReserva, setCheckingReserva] = useState(true);\r\n  const router = useRouter();\r\n  const { addNotification } = useNotification();\r\n\r\n  useEffect(() => {\r\n    const checkAuth = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          router.push('/login');\r\n          return;\r\n        }\r\n\r\n        const decoded = jwtDecode(token);\r\n        const currentTime = Date.now() / 1000;\r\n        if (decoded.exp && decoded.exp < currentTime) {\r\n          localStorage.removeItem('token');\r\n          localStorage.removeItem('refresh_token');\r\n          router.push('/login');\r\n          return;\r\n        }\r\n\r\n        // Función para obtener habitaciones disponibles con fechas\r\n        await fetchAvailableRooms(token, false); // No incluir fechas en la carga inicial\r\n      } catch (error) {\r\n        console.error('Error:', error);\r\n        setError('Error al cargar las habitaciones');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [router]);\r\n\r\n  // Nueva función para obtener habitaciones disponibles\r\n  const fetchAvailableRooms = async (token = null, includeDates = false) => {\r\n    try {\r\n      setUpdatingRooms(true);\r\n      const authToken = token || localStorage.getItem('token');\r\n      if (!authToken) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n\r\n      // Construir URL con parámetros de fecha solo si se especifica\r\n      let url = `${process.env.NEXT_PUBLIC_API_BASE_URL}/api/habitaciones/disponibles/`;\r\n      \r\n      if (includeDates && dateRange[0] && dateRange[1]) {\r\n        const fechaInicio = dateRange[0].toISOString().split('T')[0];\r\n        const fechaFin = dateRange[1].toISOString().split('T')[0];\r\n        url += `?fecha_inicio=${fechaInicio}&fecha_fin=${fechaFin}`;\r\n      }\r\n\r\n      const response = await fetch(url, {\r\n        headers: {\r\n          'Authorization': `Bearer ${authToken}`\r\n        }\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Error al obtener las habitaciones');\r\n      }\r\n\r\n      const data = await response.json();\r\n      setRooms(data);\r\n      setError(null);\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      setError('Error al cargar las habitaciones disponibles');\r\n    } finally {\r\n      setUpdatingRooms(false);\r\n    }\r\n  };\r\n\r\n  // Efecto para actualizar habitaciones cuando cambian las fechas\r\n  useEffect(() => {\r\n    if (dateRange[0] && dateRange[1] && !loading) {\r\n      fetchAvailableRooms(null, true); // Incluir fechas solo cuando se cambian\r\n    }\r\n  }, [dateRange]);\r\n\r\n  useEffect(() => {\r\n    const checkReservaActiva = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          setCheckingReserva(false);\r\n          return;\r\n        }\r\n        const response = await fetch(`${process.env.NEXT_PUBLIC_API_BASE_URL}/api/reservas/`, {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n        });\r\n        if (!response.ok) {\r\n          setCheckingReserva(false);\r\n          return;\r\n        }\r\n        const reservas = await response.json();\r\n        const pagadas = reservas.filter(r => r.estado === 'pagada');\r\n        const checkinAceptado = reservas.filter(r => r.estado === 'checkin_aceptado');\r\n        // Bloquear solo si NO hay pagadas y SÍ hay al menos una con checkin_aceptado\r\n        setReservaActiva(pagadas.length === 0 && checkinAceptado.length > 0);\r\n      } catch (e) {\r\n        setReservaActiva(false);\r\n      } finally {\r\n        setCheckingReserva(false);\r\n      }\r\n    };\r\n    checkReservaActiva();\r\n  }, [router]);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('refresh_token');\r\n    router.push('/login');\r\n  };\r\n\r\n  const handleReservar = async (roomId) => {\r\n    const room = rooms.find(r => r.id === roomId);\r\n    setSelectedRoom(room);\r\n    setShowModal(true);\r\n  };\r\n\r\n  const confirmReservar = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n\r\n      // Crear la reserva en la base de datos\r\n      const response = await fetch(`${process.env.NEXT_PUBLIC_API_BASE_URL}/api/reservas/`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          habitacion_id: selectedRoom.id,\r\n          fecha_inicio: dateRange[0].toISOString().split('T')[0],\r\n          fecha_fin: dateRange[1].toISOString().split('T')[0],\r\n          estado: 'pendiente'\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const contentType = response.headers.get('content-type');\r\n        let errorMsg = 'Error al crear la reserva';\r\n        if (contentType && contentType.includes('application/json')) {\r\n          const errorData = await response.json();\r\n          errorMsg = JSON.stringify(errorData) || errorMsg;\r\n        } else {\r\n          errorMsg = 'Error en el servidor o endpoint no encontrado';\r\n        }\r\n        throw new Error(errorMsg);\r\n      }\r\n\r\n      const reservaData = await response.json();\r\n      \r\n      // Solo guardamos en localStorage si la reserva se creó exitosamente\r\n      localStorage.setItem('ultima_reserva', JSON.stringify({\r\n        id: reservaData.id,\r\n        habitacion: selectedRoom.numero_habitacion,\r\n        tipo: selectedRoom.tipo_habitacion,\r\n        fecha_inicio: dateRange[0].toISOString().split('T')[0],\r\n        fecha_fin: dateRange[1].toISOString().split('T')[0],\r\n        noches: calculateNights(),\r\n        precio_noche: selectedRoom.precio,\r\n        total: calculateTotal(),\r\n        estado: 'pendiente'\r\n      }));\r\n      \r\n      // Actualizar la lista de habitaciones\r\n      const updatedRooms = rooms.filter(room => room.id !== selectedRoom.id);\r\n      setRooms(updatedRooms);\r\n      \r\n      // Actualizar la lista completa desde el servidor\r\n      await fetchAvailableRooms(null, true); // Incluir fechas para verificar disponibilidad\r\n      \r\n      setShowModal(false);\r\n      \r\n      // Redirigir a la página de pagos\r\n      addNotification('Reserva creada, procede al pago', 'success');\r\n      router.push('/pagos');\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      alert(error.message || 'Error al crear la reserva. Por favor, intente nuevamente.');\r\n    }\r\n  };\r\n\r\n  const calculateNights = () => {\r\n    if (!dateRange[0] || !dateRange[1]) return 0;\r\n    const diffTime = Math.abs(dateRange[1] - dateRange[0]);\r\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\r\n  };\r\n\r\n  const calculateTotal = () => {\r\n    if (!selectedRoom) return 0;\r\n    return (selectedRoom.precio * calculateNights()).toFixed(2);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-[#FFF3E0] to-[#FFE4C4]\">\r\n      {/* Left Sidebar */}\r\n      <div className=\"fixed left-0 top-0 h-full w-64 bg-gradient-to-b from-[#8B4513] to-[#A0522D] p-6 flex flex-col shadow-xl\">\r\n        {/* Menu Items */}\r\n        <div className=\"flex-1 space-y-4\">\r\n          <Link href=\"/home\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaHome size={24} />\r\n            <span className=\"text-lg font-semibold\">Home</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/reservar\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/40 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/60 transition-all duration-300 transform hover:scale-105\">\r\n            <FaBed size={24} />\r\n            <span className=\"text-lg font-semibold\">Reservar</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/check-in\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaMapMarkerAlt size={24} />\r\n            <span className=\"text-lg font-semibold\">Check-In</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/check-out\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaSignOutAlt size={24} />\r\n            <span className=\"text-lg font-semibold\">Check-Out</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/pagos\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaMoneyBill size={24} />\r\n            <span className=\"text-lg font-semibold\">Pagos</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/notificaciones\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaBell size={24} />\r\n            <span className=\"text-lg font-semibold\">Notificaciones</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/configuraciones\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaCog size={24} />\r\n            <span className=\"text-lg font-semibold\">Configuraciones</span>\r\n          </Link>\r\n        </div>\r\n\r\n        {/* Logout Button */}\r\n        <button \r\n          onClick={handleLogout}\r\n          className=\"flex items-center space-x-3 p-4 mt-4 bg-[#A0522D]/80 text-white rounded-xl hover:bg-[#8B4513] transition-all duration-300 transform hover:scale-105 shadow-lg\"\r\n        >\r\n          <FaPowerOff size={24} />\r\n          <span className=\"text-lg font-semibold\">Cerrar Sesión</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"ml-64 p-8\">\r\n        <h1 className=\"text-4xl font-bold text-[#8B4513] mb-8\">Habitaciones Disponibles</h1>\r\n\r\n        {checkingReserva ? (\r\n          <div className=\"text-center py-8 text-[#8B4513]\">Verificando reservas activas...</div>\r\n        ) : reservaActiva ? (\r\n          <div className=\"flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl p-12 mt-12\">\r\n            <FaLock size={64} className=\"text-[#8B4513] mb-6\" />\r\n            <h2 className=\"text-2xl font-bold text-[#8B4513] mb-4\">No puedes reservar hasta finalizar tu(s) estancia(s)</h2>\r\n            <p className=\"text-[#A0522D] text-lg\">Debes hacer checkout de todas tus reservas activas antes de poder reservar otra habitación.</p>\r\n          </div>\r\n        ) : loading ? (\r\n          <div className=\"text-center py-8\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8B4513] mx-auto\"></div>\r\n            <p className=\"mt-4 text-[#8B4513]\">Cargando habitaciones...</p>\r\n          </div>\r\n        ) : error ? (\r\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\" role=\"alert\">\r\n            <strong className=\"font-bold\">Error: </strong>\r\n            <span className=\"block sm:inline\">{error}</span>\r\n          </div>\r\n        ) : (\r\n          <div>\r\n            {updatingRooms && (\r\n              <div className=\"text-center py-4 mb-6\">\r\n                <div className=\"inline-flex items-center space-x-2\">\r\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-[#8B4513]\"></div>\r\n                  <span className=\"text-[#8B4513]\">Actualizando habitaciones disponibles...</span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n              {rooms.map((room) => (\r\n                <div key={room.id} className=\"bg-white/90 backdrop-blur-sm p-6 rounded-2xl shadow-xl transform hover:scale-[1.02] transition-all duration-300\">\r\n                  {/* Imagen de la habitación */}\r\n                  <div className=\"w-full h-48 relative mb-4 rounded-xl overflow-hidden\">\r\n                    {room.imagen ? (\r\n                      <Image\r\n                        src={\r\n                          room.imagen?.startsWith('http')\r\n                            ? room.imagen\r\n                            : `${process.env.NEXT_PUBLIC_API_BASE_URL}/media/imagenes/habitaciones/${room.imagen}`\r\n                        }\r\n                        alt={`Habitación ${room.numero_habitacion}`}\r\n                        fill\r\n                        className=\"object-cover\"\r\n                      />\r\n                    ) : (\r\n                      <div className=\"w-full h-full bg-[#F5E1C0] flex items-center justify-center\">\r\n                        <FaBed size={48} className=\"text-[#8B4513]\" />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"flex justify-between items-start mb-4\">\r\n                    <h2 className=\"text-2xl font-bold text-[#8B4513]\">Habitación {room.numero_habitacion}</h2>\r\n                    <span className=\"bg-green-100 text-green-800 text-sm font-semibold px-3 py-1 rounded-full\">\r\n                      Disponible\r\n                    </span>\r\n                  </div>\r\n                  \r\n                  <div className=\"space-y-4\">\r\n                    <p className=\"text-[#8B4513]\">\r\n                      <span className=\"font-semibold\">Tipo:</span> {room.tipo_habitacion}\r\n                    </p>\r\n                    <p className=\"text-[#8B4513]\">\r\n                      <span className=\"font-semibold\">Precio por noche:</span> ${room.precio}\r\n                    </p>\r\n                    \r\n                    {room.descripcion && (\r\n                      <p className=\"text-[#8B4513]\">\r\n                        <span className=\"font-semibold\">Descripción:</span> {room.descripcion}\r\n                      </p>\r\n                    )}\r\n\r\n                    <div className=\"mt-6\">\r\n                      <button\r\n                        onClick={() => handleReservar(room.id)}\r\n                        className=\"w-full bg-[#8B4513] text-white py-3 rounded-xl hover:bg-[#A0522D] transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2\"\r\n                      >\r\n                        <FaBed size={20} />\r\n                        <span>Reservar Ahora</span>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Top Right Icons */}\r\n      <div className=\"fixed top-6 right-6 flex space-x-4\">\r\n        <button className=\"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all duration-300 transform hover:scale-110\">\r\n          <FaBell size={24} className=\"text-[#8B4513]\" />\r\n        </button>\r\n        <button className=\"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all duration-300 transform hover:scale-110\">\r\n          <FaCog size={24} className=\"text-[#8B4513]\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Modal de Confirmación */}\r\n      {showModal && selectedRoom && (\r\n        <div className=\"fixed inset-0 backdrop-blur-sm bg-black/30 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white/95 backdrop-blur-md rounded-2xl p-8 max-w-2xl w-full mx-4 shadow-2xl\">\r\n            <h2 className=\"text-2xl font-bold text-[#8B4513] mb-6\">Confirmar Reserva</h2>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n              {/* Información de la habitación */}\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-[#8B4513] mb-4\">Detalles de la Habitación</h3>\r\n                {/* Imagen de la habitación */}\r\n                <div className=\"w-full h-48 relative mb-4 rounded-xl overflow-hidden\">\r\n                  {selectedRoom.imagen ? (\r\n                    <Image\r\n                      src={\r\n                        selectedRoom.imagen?.startsWith('http')\r\n                          ? selectedRoom.imagen\r\n                          : `${process.env.NEXT_PUBLIC_API_BASE_URL}/media/imagenes/habitaciones/${selectedRoom.imagen}`\r\n                      }\r\n                      alt={`Habitación ${selectedRoom.numero_habitacion}`}\r\n                      fill\r\n                      className=\"object-cover\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-[#F5E1C0] flex items-center justify-center\">\r\n                      <FaBed size={48} className=\"text-[#8B4513]\" />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <p className=\"text-[#8B4513]\">\r\n                  <span className=\"font-semibold\">Habitación:</span> {selectedRoom.numero_habitacion}\r\n                </p>\r\n                <p className=\"text-[#8B4513]\">\r\n                  <span className=\"font-semibold\">Tipo:</span> {selectedRoom.tipo_habitacion}\r\n                </p>\r\n                <p className=\"text-[#8B4513]\">\r\n                  <span className=\"font-semibold\">Precio por noche:</span> ${selectedRoom.precio}\r\n                </p>\r\n                {selectedRoom.descripcion && (\r\n                  <p className=\"text-[#8B4513]\">\r\n                    <span className=\"font-semibold\">Descripción:</span> {selectedRoom.descripcion}\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Calendario y resumen */}\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"text-xl font-semibold text-[#8B4513] mb-4\">Selecciona tus fechas</h3>\r\n                <div className=\"calendar-container\">\r\n                  <Calendar\r\n                    onChange={setDateRange}\r\n                    value={dateRange}\r\n                    selectRange={true}\r\n                    minDate={new Date()}\r\n                    className=\"w-full border-none rounded-xl shadow-inner\"\r\n                    tileClassName=\"text-[#8B4513] hover:bg-[#CD853F]/20 transition-colors duration-200\"\r\n                  />\r\n                </div>\r\n                <div className=\"mt-4 p-4 bg-[#FFF3E0] rounded-xl\">\r\n                  <p className=\"text-[#8B4513]\">\r\n                    <span className=\"font-semibold\">Noches seleccionadas:</span> {calculateNights()}\r\n                  </p>\r\n                  <p className=\"text-[#8B4513]\">\r\n                    <span className=\"font-semibold\">Total estimado:</span> ${calculateTotal()}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-8 flex justify-end space-x-4\">\r\n              <button\r\n                onClick={() => setShowModal(false)}\r\n                className=\"px-6 py-3 text-[#8B4513] hover:text-[#A0522D] transition-colors font-semibold\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n              <button\r\n                onClick={confirmReservar}\r\n                className=\"px-6 py-3 bg-[#8B4513] text-white rounded-xl hover:bg-[#A0522D] transition-all duration-300 transform hover:scale-105 font-semibold flex items-center space-x-2\"\r\n              >\r\n                <FaCalendarAlt size={20} />\r\n                <span>Confirmar Reserva</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":"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","debugId":null}}]
}