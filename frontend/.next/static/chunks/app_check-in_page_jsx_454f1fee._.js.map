{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/Javier/Desktop/ISWElectiva110202-4/frontend/app/check-in/page.jsx"],"sourcesContent":["'use client'\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { FaHome, FaMapMarkerAlt, FaSignOutAlt, FaMoneyBill, FaBell, FaCog, FaPowerOff, FaBed, FaUser, FaIdCard, FaCar } from 'react-icons/fa';\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport { useNotification } from '../../components/NotificationContext';\r\n\r\nexport default function CheckIn() {\r\n  const [reservas, setReservas] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const router = useRouter();\r\n  const { addNotification } = useNotification();\r\n\r\n  const fetchReservas = async () => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n      const response = await fetch(`${process.env.NEXT_PUBLIC_API_BASE_URL}/api/reservas/`, {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error('Error al obtener las reservas');\r\n      }\r\n      const data = await response.json();\r\n      console.log('Reservas recibidas en check-in:', data);\r\n      // Filtrar reservas pagadas y checkin_aceptado\r\n      const paraCheckIn = data.filter(r => r.estado === 'pagada' || r.estado === 'checkin_aceptado');\r\n      setReservas(paraCheckIn);\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      setError('Error al cargar las reservas');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchReservas();\r\n  }, [router]);\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('refresh_token');\r\n    router.push('/login');\r\n  };\r\n\r\n  const handleCheckIn = async (reservaId) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n      const response = await fetch(`${process.env.NEXT_PUBLIC_API_BASE_URL}/api/reservas/${reservaId}/`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ estado: 'checkin_aceptado' }),\r\n      });\r\n      if (!response.ok) {\r\n        throw new Error('Error al realizar el check-in');\r\n      }\r\n      addNotification('Check-In realizado', 'success');\r\n      // Recargar la lista de reservas desde el backend\r\n      fetchReservas();\r\n    } catch (error) {\r\n      console.error('Error:', error);\r\n      alert('Error al realizar el check-in');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-[#FFF3E0] to-[#FFE4C4]\">\r\n      {/* Left Sidebar */}\r\n      <div className=\"fixed left-0 top-0 h-full w-64 bg-gradient-to-b from-[#8B4513] to-[#A0522D] p-6 flex flex-col shadow-xl\">\r\n        {/* Menu Items */}\r\n        <div className=\"flex-1 space-y-4\">\r\n          <Link href=\"/home\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaHome size={24} />\r\n            <span className=\"text-lg font-semibold\">Home</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/reservar\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaBed size={24} />\r\n            <span className=\"text-lg font-semibold\">Reservar</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/check-in\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/40 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/60 transition-all duration-300 transform hover:scale-105\">\r\n            <FaMapMarkerAlt size={24} />\r\n            <span className=\"text-lg font-semibold\">Check-In</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/check-out\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaSignOutAlt size={24} />\r\n            <span className=\"text-lg font-semibold\">Check-Out</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/pagos\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaMoneyBill size={24} />\r\n            <span className=\"text-lg font-semibold\">Pagos</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/notificaciones\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaBell size={24} />\r\n            <span className=\"text-lg font-semibold\">Notificaciones</span>\r\n          </Link>\r\n          \r\n          <Link href=\"/configuraciones\" className=\"flex items-center space-x-3 p-4 bg-[#CD853F]/20 backdrop-blur-sm text-white rounded-xl hover:bg-[#CD853F]/40 transition-all duration-300 transform hover:scale-105\">\r\n            <FaCog size={24} />\r\n            <span className=\"text-lg font-semibold\">Configuraciones</span>\r\n          </Link>\r\n        </div>\r\n\r\n        {/* Logout Button */}\r\n        <button \r\n          onClick={handleLogout}\r\n          className=\"flex items-center space-x-3 p-4 mt-4 bg-[#A0522D]/80 text-white rounded-xl hover:bg-[#8B4513] transition-all duration-300 transform hover:scale-105 shadow-lg\"\r\n        >\r\n          <FaPowerOff size={24} />\r\n          <span className=\"text-lg font-semibold\">Cerrar Sesi贸n</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Main Content */}\r\n      <div className=\"ml-64 p-8\">\r\n        <h1 className=\"text-4xl font-bold text-[#8B4513] mb-8\">Check-In</h1>\r\n\r\n        {loading ? (\r\n          <div className=\"text-center py-8\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-[#8B4513] mx-auto\"></div>\r\n            <p className=\"mt-4 text-[#8B4513]\">Cargando reservas...</p>\r\n          </div>\r\n        ) : error ? (\r\n          <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\" role=\"alert\">\r\n            <strong className=\"font-bold\">Error: </strong>\r\n            <span className=\"block sm:inline\">{error}</span>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            {reservas.map((reserva) => (\r\n              <div key={reserva.id} className=\"bg-white/90 backdrop-blur-sm p-6 rounded-2xl shadow-xl transform hover:scale-[1.02] transition-all duration-300\">\r\n                {/* Imagen de la habitaci贸n */}\r\n                <div className=\"w-full h-48 relative mb-4 rounded-xl overflow-hidden\">\r\n                  {reserva.habitacion.imagen ? (\r\n                    <Image\r\n                      src={\r\n                        reserva.habitacion.imagen?.startsWith('http')\r\n                          ? reserva.habitacion.imagen\r\n                          : `${process.env.NEXT_PUBLIC_API_BASE_URL}/media/imagenes/habitaciones/${reserva.habitacion.imagen}`\r\n                      }\r\n                      alt={`Habitaci贸n ${reserva.habitacion.numero_habitacion}`}\r\n                      fill\r\n                      className=\"object-cover\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-[#F5E1C0] flex items-center justify-center\">\r\n                      <FaBed size={48} className=\"text-[#8B4513]\" />\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                  <h2 className=\"text-2xl font-bold text-[#8B4513]\">Habitaci贸n {reserva.habitacion.numero_habitacion}</h2>\r\n                  {reserva.estado === 'pagada' ? (\r\n                    <span className=\"px-3 py-1 rounded-full text-sm font-semibold bg-green-100 text-green-800\">Pagada</span>\r\n                  ) : (\r\n                    <span className=\"px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800\">Check-in realizado</span>\r\n                  )}\r\n                </div>\r\n                <div className=\"space-y-4\">\r\n                  <div className=\"flex items-center space-x-2 text-[#8B4513]\">\r\n                    <FaBed className=\"text-[#8B4513]\" />\r\n                    <span className=\"font-semibold\">Tipo:</span>\r\n                    <span>{reserva.habitacion.tipo_habitacion}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2 text-[#8B4513]\">\r\n                    <FaUser className=\"text-[#8B4513]\" />\r\n                    <span className=\"font-semibold\">Fecha de llegada:</span>\r\n                    <span>{reserva.fecha_inicio}</span>\r\n                  </div>\r\n                  <div className=\"flex items-center space-x-2 text-[#8B4513]\">\r\n                    <FaCar className=\"text-[#8B4513]\" />\r\n                    <span className=\"font-semibold\">Fecha de salida:</span>\r\n                    <span>{reserva.fecha_fin}</span>\r\n                  </div>\r\n                </div>\r\n                {reserva.estado === 'pagada' && (\r\n                  <button\r\n                    onClick={() => handleCheckIn(reserva.id)}\r\n                    className=\"w-full mt-6 bg-[#8B4513] text-white py-3 px-4 rounded-xl hover:bg-[#A0522D] transition-all duration-300 transform hover:scale-105\"\r\n                  >\r\n                    Realizar Check-In\r\n                  </button>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Top Right Icons */}\r\n      <div className=\"fixed top-6 right-6 flex space-x-4\">\r\n        <button className=\"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all duration-300 transform hover:scale-110\">\r\n          <FaBell size={24} className=\"text-[#8B4513]\" />\r\n        </button>\r\n        <button className=\"p-3 bg-white/90 backdrop-blur-sm rounded-full shadow-lg hover:bg-white transition-all duration-300 transform hover:scale-110\">\r\n          <FaCog size={24} className=\"text-[#8B4513]\" />\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n} "],"names":[],"mappings":"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","debugId":null}}]
}